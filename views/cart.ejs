<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Google Font: Montserrat (Gotham-like) -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <title>Supermarket App - Cart</title>
  <style>
    .btn-primary.btn-cta {
      background: #ffffff;
      color: #000 !important;
      font-weight: 600;
      letter-spacing: .03em;
      border-radius: 0.35rem;
      border: 1px solid #ffffff;
      transition: 200ms ease-in-out;
      text-transform: uppercase;
      margin-top: 0.5rem;
    }

    .btn-primary.btn-cta:hover {
        background: #e6e6e6;
        color: #000;
        transform: translateY(-2px);
        box-shadow: 0 4px 16px rgba(255,255,255,0.35);
      }

    body {
      background-image: url('/images/bg.png');
      background-size: cover;
      background-position: center center;
      background-repeat: no-repeat;
      background-attachment: fixed;
      background-color: #111213;
      color: #fff;
      font-family: 'Montserrat', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }
    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.45);
      pointer-events: none;
      z-index: 0;
    }
    .custom-navbar { background-color: transparent !important; padding-top:1.05rem; padding-bottom:1.05rem; min-height:80px; z-index:1030; }

    .table-card {
      margin-top: 1.5rem;
      background: rgba(255,255,255,0.04);
      -webkit-backdrop-filter: blur(8px);
      backdrop-filter: blur(8px);
      border-radius: 0.6rem;
      padding: 1rem 1.2rem;
      color: #110f0f;
      overflow: hidden;
    }

    .table-card thead th,
    .table-card tbody td {
      color: #ffffff;
      background: transparent;
      vertical-align: middle;
      font-weight: 600;
    }

    .product-image { max-height:64px; border-radius: 0.35rem; object-fit: cover; }

    .table-card table { border-collapse: separate; border-spacing: 0; }
    .table-card thead th { background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03)); padding: 0.6rem 0.75rem; }
    .table-card thead th:first-child { border-top-left-radius: 0.6rem; }
    .table-card thead th:last-child { border-top-right-radius: 0.6rem; }

    /* Small circular remove button in cart rows */
    .remove-btn {
      width: 34px;
      height: 34px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      border: 1px solid rgba(255,255,255,0.08);
      background: transparent;
      color: #fff;
      padding: 0;
      font-weight: 700;
      line-height: 1;
      cursor: pointer;
    }
    .remove-btn:hover { background: rgba(220,53,69,0.14); color: #fff; }

    .brand-logo {
      font-family: 'Montserrat', system-ui, sans-serif;
      display: inline-flex;
      flex-direction: column;
      text-align: center;
      text-decoration: none;
      line-height: 1.05;
      padding-left: 0.1rem;
    }

    .brand-main {
      font-size: 1.45rem;
      font-weight: 700;
      letter-spacing: 0.33em;
      text-transform: uppercase;
      color: #ffffff;
    }

    .brand-sub {
      font-size: 0.68rem;
      font-weight: 500;
      letter-spacing: 0.28em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.75);
      margin-top: 0.15rem;
    }

    footer.site-footer { background:#0b0c0d; color:#fff; padding:2.5rem 0; border-top:1px solid rgba(255,255,255,0.03); }
    a, .nav-link { color: rgba(255,255,255,0.95); }
  </style>
</head>
<body class="d-flex flex-column min-vh-100">
  <a class="visually-hidden-focusable" href="#main-content">Skip to main content</a>
  <nav class="navbar navbar-expand-sm navbar-dark bg-dark custom-navbar">
    <div class="container-fluid" role="navigation" aria-label="Main navigation">
      <a class="navbar-brand brand-logo" href="/">
        <span class="brand-main">SUPERMARKET</span>
        <span class="brand-sub">SINGAPORE</span>
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#collapsibleNavbar" aria-controls="collapsibleNavbar" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="collapsibleNavbar">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item d-flex align-items-center me-3">
            <span class="text-light small">Signed in as <strong><%= user.username %></strong></span>
          </li>
          <li class="nav-item me-2"><a class="btn btn-outline-light btn-sm btn-cta btn-minimal" href="/orders">My Orders</a></li>
          <li class="nav-item me-2"><a class="btn btn-outline-light btn-sm btn-cta btn-minimal" href="/shopping">Continue Shopping</a></li>
          <li class="nav-item"><a class="btn btn-outline-light btn-sm btn-cta btn-minimal" href="/logout">Logout</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <main id="main-content" class="container flex-grow-1 py-4" role="main">
    <div class="table-card">
  <h3 class="mb-3 text-white fw-bold">Your Cart</h3>
      <% if (!cart || cart.length === 0) { %>
        <p style="color: #fff;">Your cart is empty.</p>
        <a class="btn btn-outline-light" href="/shopping">Browse items</a>
      <% } else { %>
        <div class="table-responsive">
          <table class="table table-hover small text-center mb-0">
            <thead>
              <tr>
                <th style="width:48px"></th>
                <th>Product</th>
                <th>Category</th>
                <th>Image</th>
                <th>Price</th>
                <th>Quantity</th>
                <th>Subtotal</th>
              </tr>
            </thead>
            <tbody>
              <% let total = 0; %>
              <% for (let i = 0; i < cart.length; i++) { %>
                <% const itemId = cart[i].id || cart[i].productId; %>
                <tr>
                  <td>
                    <form action="/remove-from-cart/<%= itemId %>" method="POST" onsubmit="return confirm('Remove this item from cart?');">
                      <button type="submit" class="remove-btn" title="Remove">x</button>
                    </form>
                  </td>
                  <td><a href="/product/<%= itemId %>"><%= cart[i].productName %></a></td>
                  <td><%= cart[i].category || '-' %></td>
                  <td><img class="product-image" src="/images/<%= cart[i].image %>" alt="<%= cart[i].productName %>" /></td>
                  <td>$<%= cart[i].price.toFixed(2) %></td>
                  <td>
                    <form action="/update-cart/<%= itemId %>" method="POST" class="d-inline-flex align-items-center justify-content-center gap-2">
                      <input type="number" name="quantity" value="<%= cart[i].quantity %>" min="1" class="form-control form-control-sm text-center" style="width:80px">
                      <button type="submit" class="btn btn-outline-light btn-sm">Update</button>
                    </form>
                  </td>
                  <td>$<%= (cart[i].price * cart[i].quantity).toFixed(2) %></td>
                </tr>
                <% total += cart[i].price * cart[i].quantity; %>
              <% } %>
            </tbody>
          </table>
        </div>

        <div class="d-flex justify-content-between align-items-center mt-3">
          <div>
            <a class="btn btn-outline-light" href="/shopping">Continue Shopping</a>
            <form action="/clear-cart" method="POST" class="d-inline-block ms-2" onsubmit="return confirm('Clear all items from your cart?');">
              <button type="submit" class="btn btn-outline-danger">Clear Cart</button>
            </form>
          </div>
          <div class="text-end">
            <h5 class="mb-1 text-white fw-bold">Total: $<%= total.toFixed(2) %></h5>
            <a class="btn btn-primary btn-cta" href="/checkout">Proceed to Checkout</a>
          </div>
        </div>
      <% } %>
    </div>
  </main>

<footer class="site-footer mt-auto">
  <div class="container text-center">
    <p class="mb-1">Supermarket Singapore elevates everyday shopping with curated essentials, premium quality, and a refined digital experience. Seamless, stylish, and sophisticated — where everyday living meets modern luxury.</p>
    <small class="small">© <%= new Date().getFullYear() %> — by Saw Kaung Khant Thiha.</small>
  </div>
</footer>
</body>
</html>

